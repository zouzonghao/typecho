# Typecho 多关键字搜索功能

## 功能说明

本功能为 Typecho 博客系统添加了多关键字搜索支持，用户可以通过逗号分隔多个关键字进行精确搜索。

## 实现方式

### 1. 核心修改
- 修改了 `var/Widget/Archive.php` 文件中的 `searchHandle` 方法
- 支持多种分隔符：空格、英文逗号、中文逗号、中文顿号
- 使用 AND 逻辑连接多个关键字，确保搜索结果包含所有关键字
- 修复了 URL 编码问题，确保分隔符在重定向过程中正确处理

### 2. 界面优化
- 更新了搜索框的提示文字，告知用户可以使用空格或逗号分隔多个关键字
- 保持了原有的搜索界面风格
- 修改搜索表单为 GET 方法，避免重定向问题

## 使用方法

### 基本搜索
在搜索框中输入单个关键字进行搜索：
```
PHP
```

### 多关键字搜索
使用空格或逗号分隔多个关键字：
```
PHP MySQL
PHP,MySQL
PHP，MySQL
PHP、MySQL
docker mac
docker,mac
```

### 搜索逻辑
- 多个关键字之间使用 AND 逻辑连接
- 每个关键字会在文章标题和内容中搜索
- 搜索结果必须包含所有输入的关键字
- 单关键字搜索完全兼容，无需特殊处理

## 技术特点

### 高性能
- 直接修改核心搜索逻辑，无需额外的插件
- 使用数据库原生 LIKE 查询，性能优秀
- 最小化代码修改，保持系统稳定性
- 统一的搜索处理逻辑，避免代码重复（DRY原则）

### URL 编码处理
- 修复了 URL 编码问题，确保分隔符在重定向过程中正确处理
- 使用 GET 方法避免重定向问题
- 正确处理多种分隔符（空格、逗号等）

### 兼容性
- 完全兼容原有的单关键字搜索
- 支持多种分隔符：空格、英文逗号、中文逗号、中文顿号
- 自动过滤空关键字和重复关键字

### 安全性
- 保持了原有的隐私保护机制
- 使用参数化查询，防止SQL注入
- 对输入进行适当的清理和验证

## 文件修改清单

1. `var/Widget/Archive.php` - 核心搜索逻辑修改
2. `usr/themes/default/header.php` - 搜索框提示文字更新和表单方法修改

## 注意事项

- 修改涉及核心文件，建议在修改前备份
- 如果升级 Typecho 版本，可能需要重新应用此修改
- 建议在测试环境中先验证功能正常后再部署到生产环境

## 示例

### 搜索示例
```
输入: "PHP MySQL 数据库"
结果: 返回标题或内容中同时包含"PHP"、"MySQL"、"数据库"的文章

输入: "docker,mac"
结果: 返回标题或内容中同时包含"docker"、"mac"的文章

输入: "Typecho，主题，开发"
结果: 返回标题或内容中同时包含"Typecho"、"主题"、"开发"的文章

输入: "PHP MySQL 数据库"
结果: 返回标题或内容中同时包含"PHP"、"MySQL"、"数据库"的文章
```

这个功能让用户可以更精确地搜索到需要的内容，提高了搜索的准确性和用户体验。 